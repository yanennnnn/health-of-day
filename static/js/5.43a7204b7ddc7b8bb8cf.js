webpackJsonp([5],{"0/Vb":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("7t+N"),r=a.n(s),i={data:function(){return{cart:{carts:[]},form:{user:{name:"",tel:"",email:"",address:""},message:""},isLoading:!1,leave:!1}},methods:{getCart:function(){var t=this;t.isLoading=!0,this.$http.get("https://vue-course-api.hexschool.io/api/yanennn/cart").then(function(e){t.cart=e.data.data,t.isLoading=!1})},createOrder:function(){var t=this,e=this,a=e.form;e.isLoading=!0,this.$validator.validate().then(function(s){s?t.$http.post("https://vue-course-api.hexschool.io/api/yanennn/order",{data:a}).then(function(t){e.leave=!0,e.getCart(),t.data.success&&(e.$router.push("/customerCheckout/"+t.data.orderId),e.$bus.$emit("cartCreate:push")),e.isLoading=!1}):e.isLoading=!1})}},created:function(){this.getCart()},beforeRouteLeave:function(t,e,a){this.leave?a():(r()("#CreateOrder").modal("show"),r()(".confirm").on("click",function(){a()}),r()(".cancel").on("click",function(){a(!1)}))}},o={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container customerOrder"},[s("loading",{attrs:{active:t.isLoading},on:{"update:active":function(e){t.isLoading=e}}},[s("template",{slot:"default"},[s("img",{attrs:{src:a("GuUm"),width:"70px"}}),t._v(" "),s("img",{attrs:{src:a("CBvG"),width:"100px"}})])],2),t._v(" "),s("h2",{staticClass:"pt-5 text-center"},[t._v("訂購資料")]),t._v(" "),s("div",{staticClass:"mt-4  border-primary row justify-content-center"},[s("div",{staticClass:"col-lg-5 col-md-7 col-10  customerOrder-cart "},[s("p",{staticClass:"h5 my-3 ml-2 "},[t._v("訂單明細")]),t._v(" "),s("div",{},[s("table",{staticClass:"table"},[s("tbody",t._l(t.cart.carts,function(e){return s("tr",{key:e.id},[s("th",{staticClass:"align-middle text-center d-sm-block d-none",attrs:{scope:"row"}},[s("img",{attrs:{src:e.product.imageUrl,width:"60",height:"65",alt:""}})]),t._v(" "),s("td",{staticClass:"align-middle"},[s("span",[t._v(t._s(e.product.title))]),t._v(" "),s("br"),t._v(" "),s("span",{staticClass:"text-muted"},[t._v("x "+t._s(e.qty))])]),t._v(" "),s("td",{staticClass:"align-middle",attrs:{width:"20"}},[t._v(t._s(t._f("currency")(e.final_total)))])])}),0),t._v(" "),s("tfoot",[t._m(0),t._v(" "),s("tr",[s("td",{staticClass:"text-right  text-danger font-weight-bold",staticStyle:{border:"none"},attrs:{colspan:"3"}},[t._v("總計: "),s("span",{staticClass:"h2"},[t._v(t._s(t._f("currency")(t.cart.final_total)))])])])])])])]),t._v(" "),s("div",{staticClass:"col-sm-9 col-11 mt-5"},[s("p",{staticClass:"h3 text-center"},[t._v("收件資料")]),t._v(" "),s("div",{staticClass:"mt-3"},[s("form",{on:{submit:function(e){return e.preventDefault(),t.createOrder(e)}}},[s("div",{staticClass:"form-row"},[s("div",{staticClass:"form-group col-md-6"},[s("label",{attrs:{for:"userName"}},[t._v("收件人姓名*")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.name,expression:"form.user.name"},{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"form-control",class:{"is-invalid":t.errors.has("name")},attrs:{type:"text",id:"userName",name:"name",placeholder:"請輸入姓名"},domProps:{value:t.form.user.name},on:{input:function(e){e.target.composing||t.$set(t.form.user,"name",e.target.value)}}}),t._v(" "),t.errors.has("name")?s("small",{staticClass:"text-danger"},[t._v("姓名不得為空")]):t._e()]),t._v(" "),s("div",{staticClass:"form-group col-md-6"},[s("label",{attrs:{for:"userTel"}},[t._v("手機號碼*")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.tel,expression:"form.user.tel"},{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"form-control",class:{"is-invalid":t.errors.has("tel")},attrs:{type:"text",id:"userTel",name:"tel",placeholder:"請輸入手機號碼",onkeyup:"value=value.replace(/[^0-9]/g,'')"},domProps:{value:t.form.user.tel},on:{input:function(e){e.target.composing||t.$set(t.form.user,"tel",e.target.value)}}}),t._v(" "),t.errors.has("tel")?s("small",{staticClass:"text-danger"},[t._v("手機號碼不得為空")]):t._e()])]),t._v(" "),s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"userEmail"}},[t._v("信箱*")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.email,expression:"form.user.email"},{name:"validate",rawName:"v-validate",value:"required|email",expression:"'required|email'"}],staticClass:"form-control",class:{"is-invalid":t.errors.has("email")},attrs:{type:"email",id:"userEmail",name:"email",placeholder:"請輸入信箱"},domProps:{value:t.form.user.email},on:{input:function(e){e.target.composing||t.$set(t.form.user,"email",e.target.value)}}}),t._v(" "),t.errors.has("email")?s("small",{staticClass:"text-danger"},[t._v(t._s(t.errors.first("email")))]):t._e()]),t._v(" "),s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"userAddress"}},[t._v("地址*")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.address,expression:"form.user.address"},{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"form-control",class:{"is-invalid":t.errors.has("address")},attrs:{type:"text",id:"userAddress",name:"address",placeholder:"請輸入地址"},domProps:{value:t.form.user.address},on:{input:function(e){e.target.composing||t.$set(t.form.user,"address",e.target.value)}}}),t._v(" "),t.errors.has("address")?s("small",{staticClass:"text-danger"},[t._v("地址不得為空")]):t._e()]),t._v(" "),s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"userTextarea"}},[t._v("留言備註")]),t._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.message,expression:"form.message"}],staticClass:"form-control",attrs:{id:"userTextarea",rows:"3"},domProps:{value:t.form.message},on:{input:function(e){e.target.composing||t.$set(t.form,"message",e.target.value)}}})]),t._v(" "),t._m(1)])])])]),t._v(" "),t._m(2)],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("tr",[e("td",{staticClass:"text-right p-0 pr-2",staticStyle:{border:"none"},attrs:{colspan:"3"}},[this._v("運費:"),e("span",{staticClass:"ml-4 mr-1"},[this._v("$0")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"d-flex justify-content-center mt-5"},[e("button",{staticClass:"py-2 btn btn-primary mx-2 d-block",staticStyle:{width:"250px"},attrs:{type:"submit"}},[this._v("確認送出 ")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal fade",attrs:{id:"CreateOrder",tabindex:"-1",role:"dialog","aria-labelledby":"CreateOrderCenterTitle","aria-hidden":"true","data-backdrop":"static"}},[e("div",{staticClass:"modal-dialog modal-dialog-centered",attrs:{role:"document"}},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-body leave-modal"},[e("p",[this._v("您的訂單資料尚未送出，確定要離開此頁?")]),this._v(" "),e("div",{staticClass:"text-right"},[e("button",{staticClass:"mr-2 confirm",attrs:{type:"button","data-dismiss":"modal"}},[this._v("確定")]),this._v(" "),e("button",{staticClass:"cancel",attrs:{type:"button","data-dismiss":"modal"}},[this._v("取消")])])])])])])}]};var l=a("VU/8")(i,o,!1,function(t){a("29JQ")},"data-v-6c823772",null);e.default=l.exports},"29JQ":function(t,e){}});
//# sourceMappingURL=5.43a7204b7ddc7b8bb8cf.js.map